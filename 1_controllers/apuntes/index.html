
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.3.2">
    
    
      
        <title>Controllers - IUDM-iOS-basico</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.24c991ad.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.3f5d1f46.min.css">
        
          
          
          <meta name="theme-color" content="#009485">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      


    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    <script>function __prefix(e){return new URL("../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#sesion-1-view-controllers" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../.." title="IUDM-iOS-basico" class="md-header__button md-logo" aria-label="IUDM-iOS-basico" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IUDM-iOS-basico
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Controllers
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Limpiar" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="IUDM-iOS-basico" class="md-nav__button md-logo" aria-label="IUDM-iOS-basico" data-md-component="logo">
      
  <img src="../../logo.png" alt="logo">

    </a>
    IUDM-iOS-basico
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../2_vistas/apuntes/" class="md-nav__link">
        Vistas
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../2_vistas/ejercicios/" class="md-nav__link">
        Ejercicios sobre vistas
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Controllers
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Controllers
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#view-controllers-funciones-basicas" class="md-nav__link">
    View controllers. Funciones básicas
  </a>
  
    <nav class="md-nav" aria-label="View controllers. Funciones básicas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#otras-tareas-de-los-view-controllers" class="md-nav__link">
    Otras tareas de los view controllers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ciclo-de-vida-de-un-controller" class="md-nav__link">
    Ciclo de vida de un controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instanciar-controladores-y-vistas" class="md-nav__link">
    Instanciar controladores y vistas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navegacion-con-storyboards" class="md-nav__link">
    Navegación con Storyboards
  </a>
  
    <nav class="md-nav" aria-label="Navegación con Storyboards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#el-controller-inicial" class="md-nav__link">
    El controller inicial
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#el-controller-de-cada-pantalla" class="md-nav__link">
    El controller de cada pantalla
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#segues" class="md-nav__link">
    Segues
  </a>
  
    <nav class="md-nav" aria-label="Segues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tipos-basicos-de-segue" class="md-nav__link">
    Tipos básicos de segue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilos-de-presentacion-y-de-transicion" class="md-nav__link">
    Estilos de presentación y de transición
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pasar-datos-de-un-controller-a-otro-en-un-segue" class="md-nav__link">
    Pasar datos de un controller a otro en un segue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segues-que-vuelven-atras-unwind-segues" class="md-nav__link">
    Segues que vuelven atrás (unwind segues)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ejercicios/" class="md-nav__link">
        Ejercicios de controllers
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../4_tablas/apuntes/" class="md-nav__link">
        Tablas
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../4_tablas/ejercicios/" class="md-nav__link">
        Ejercicios de tablas
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../3_autolayout/apuntes/" class="md-nav__link">
        Autolayout
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../3_autolayout/ejercicios/" class="md-nav__link">
        Ejercicios de autolayout
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../5_contenedores/apuntes/" class="md-nav__link">
        Controladores contenedores
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../proyecto/lista_compra/" class="md-nav__link">
        Miniproyecto
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#view-controllers-funciones-basicas" class="md-nav__link">
    View controllers. Funciones básicas
  </a>
  
    <nav class="md-nav" aria-label="View controllers. Funciones básicas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#otras-tareas-de-los-view-controllers" class="md-nav__link">
    Otras tareas de los view controllers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ciclo-de-vida-de-un-controller" class="md-nav__link">
    Ciclo de vida de un controller
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#instanciar-controladores-y-vistas" class="md-nav__link">
    Instanciar controladores y vistas
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#navegacion-con-storyboards" class="md-nav__link">
    Navegación con Storyboards
  </a>
  
    <nav class="md-nav" aria-label="Navegación con Storyboards">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#el-controller-inicial" class="md-nav__link">
    El controller inicial
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#el-controller-de-cada-pantalla" class="md-nav__link">
    El controller de cada pantalla
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#segues" class="md-nav__link">
    Segues
  </a>
  
    <nav class="md-nav" aria-label="Segues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#tipos-basicos-de-segue" class="md-nav__link">
    Tipos básicos de segue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#estilos-de-presentacion-y-de-transicion" class="md-nav__link">
    Estilos de presentación y de transición
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pasar-datos-de-un-controller-a-otro-en-un-segue" class="md-nav__link">
    Pasar datos de un controller a otro en un segue
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segues-que-vuelven-atras-unwind-segues" class="md-nav__link">
    Segues que vuelven atrás (unwind segues)
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="sesion-1-view-controllers">Sesión 1: View Controllers<a class="headerlink" href="#sesion-1-view-controllers" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">Importante</p>
<p>En estos apuntes de <em>View Controllers</em> verás un ejercicio intercalado, que se irá completando poco a poco. Vale <strong>1 punto</strong> de la nota total del módulo de iOS básico.</p>
</div>
<h2 id="view-controllers-funciones-basicas"><em>View controllers</em>. Funciones básicas<a class="headerlink" href="#view-controllers-funciones-basicas" title="Permanent link">&para;</a></h2>
<p><img alt="Tomado de &quot;View Controller Programming Guide&quot; de Apple" src="../images/DraggedImage.png" title="Tomado de &quot;View Controller Programming Guide&quot; de Apple" /></p>
<p>Hay dos tipos básicos de controladores: los que muestran directamente contenido (<em>content controllers</em>) y los que contienen otros contenedores (<em>container controllers</em>). Estos últimos contienen a otros controladores. Lo que hace el contenedor es redimensionar y colocar la vista principal de sus hijos, pero cada uno de ellos es responsable de mostrar su propio contenido</p>
<p><img alt="Ejemplo de contenedor: split view en un iPad (tomado de la View Controller Programming Guide de Apple)" src="../images/DraggedImage-1.png" title="Ejemplo de contenedor: split view en un iPad (tomado de la View Controller Programming Guide de Apple)" /></p>
<h3 id="otras-tareas-de-los-view-controllers">Otras tareas de los <em>view controllers</em><a class="headerlink" href="#otras-tareas-de-los-view-controllers" title="Permanent link">&para;</a></h3>
<p>Además de gestionar la jerarquía de vistas, los controladores actúan como el “pegamento” que relaciona la vista con el modelo. El controlador es el lugar típico para poner el código que reacciona a los eventos del usuario, como por ejemplo qué hacer cuando se pulsa un botón.</p>
<blockquote>
<p>Es nuestra responsabilidad como desarrolladores asegurarnos de que no colocamos demasiada lógica en el código del <em>controller</em>. La lógica debería ir en el modelo, no en el <em>controller</em>, que debería contener el mínimo código imprescindible para comunicar vista y modelo.</p>
</blockquote>
<p>Por otro lado, los <em>controllers</em> son los responsables de adaptar las dimensiones de los componentes de la interfaz a las dimensiones reales de la pantalla. Para ello se usan varios mecanismos: <em>autolayout</em>, <em>size classes</em> y <em>traits</em>, que veremos a nivel introductorio en las siguientes sesiones.</p>
<h3 id="ciclo-de-vida-de-un-controller">Ciclo de vida de un <em>controller</em><a class="headerlink" href="#ciclo-de-vida-de-un-controller" title="Permanent link">&para;</a></h3>
<p>Cada controlador va pasando por una serie de estados conforme se carga la aplicación, se muestra la pantalla que este gestiona, se cambia de pantalla, etc. </p>
<p>Hay tres métodos principales en los que podemos colocar código propio, según el momento en que queramos que se ejecute:</p>
<ul>
<li><code>viewDidLoad()</code>: este método ya lo hemos usado en nuestras aplicaciones. Se dispara cuando se carga la raíz de la jerarquía de vistas del controlador. Típicamente se ejecutaría una sola vez en toda la aplicación, y por ello se  suele usar para inicializar propiedades del controlador. No obstante si el sistema anda bajo de memoria puede liberar la correspondiente al controlador y como resultado este método podría ejecutarse más de una vez.</li>
<li><code>viewWillAppear()</code>: se ejecuta inmediatamente antes de dibujar la vista.  </li>
<li><code>viewDidAppear()</code>: se ejecuta cuando la vista ya se ha dibujado. Útil para colocar código relativo por ejemplo a animaciones.</li>
</ul>
<p>Los métodos anteriores y sus “complementarios” (con <code>disappear</code> en lugar de <code>appear</code>) se recogen en el siguiente esquema</p>
<p><img alt="" src="../images/DraggedImage-2.png" /></p>
<h3 id="instanciar-controladores-y-vistas">Instanciar controladores y vistas<a class="headerlink" href="#instanciar-controladores-y-vistas" title="Permanent link">&para;</a></h3>
<p>Podemos hacerlo de varias formas. De más sencilla a más compleja (pero también más flexible)</p>
<ul>
<li><strong>Gráficamente, con <em>storyboards</em></strong>: tanto las vistas como el controlador están en el <em>storyboard</em></li>
<li><strong>Gráficamente, con <code>.nib</code></strong>: en cada archivo <code>nib</code> guardamos una pantalla (con su jerarquía de vistas), pero no el controlador, que se crea por código</li>
<li><strong>Totalmente por código</strong>: tenemos que instanciar el controlador y en su método  <code>loadView</code> crear la jerarquía de vistas que queremos que contenga (<code>UIView</code>, <code>UIButton</code>, lo que sea) y asignar la raíz de la jerarquía de vistas a <code>self.view</code>.</li>
</ul>
<p>Dado el tiempo disponible, solo vamos a ver la primera opción con más detalle. En general los <em>storyboards</em> van a ser suficientes para aplicaciones no demasiado complejas.</p>
<h2 id="navegacion-con-storyboards">Navegación con Storyboards<a class="headerlink" href="#navegacion-con-storyboards" title="Permanent link">&para;</a></h2>
<p>Los <em>storyboards</em> son la forma recomendada por Apple de crear interfaces de usuario. Un <em>storyboard</em> contiene la representación gráfica de las “pantallas” (los controladores) que componen nuestra aplicación y de las relaciones entre ellas. Además el sistema se encarga automáticamente de moverse por las pantallas cuando sucedan determinados eventos, instanciando los controladores y las vistas automáticamente.</p>
<p><img alt="" src="../images/storyboard.png" /></p>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p>Vamos a hacer aquí un <em>storyboard</em> muy sencillo con solo dos pantallas, pero que nos servirá para aprender lo básico de la navegación y el paso de datos entre controladores. De momento:</p>
<ul>
<li>Crea el proyecto de Xcode: <code>File &gt; New &gt; Project...</code>. En la primera pantalla del asistente elige el <em>template</em> <code>App</code>, y en la segunda pon el nombre del proyecto, <code>NavegacionStoryboard</code> y asegúrate de que el <em>Interface</em> es <code>Storyboard</code></li>
<li>En el <code>Main.storyboard</code> crea una pantalla con un botón que ponga "Pantalla secundaria" y un <code>text field</code> en el que escribiremos algo para pasárselo a la siguiente pantalla    </li>
</ul>
</div>
<p><img alt="" src="../images/ui_primaria.png" /></p>
<h3 id="el-controller-inicial">El <em>controller</em> inicial<a class="headerlink" href="#el-controller-inicial" title="Permanent link">&para;</a></h3>
<p>En cada momento habrá un <em>view controller</em> inicial que es el que se muestra cuando se carga la aplicación. Se distingue visualmente porque tiene una flecha apuntando a él desde la izquierda:</p>
<p><img alt="" src="../images/controlador_inicial.png" /></p>
<p>Para <strong>convertir un <em>view controller</em> en inicial</strong>, teniéndolo seleccionado ir al icono de propiedades <img alt="" src="../images/attr_inspector.png" /> del área de <code>Utilities</code> y marcar sobre el <em>checkbox</em> <code>Is initial view controller</code></p>
<p><img alt="" src="../images/view_controller_icon.png" /></p>
<p>También podemos arrastrar la flecha que indica que un controlador es el inicial desde el actual hasta el que queremos convertir en inicial.</p>
<h3 id="el-controller-de-cada-pantalla">El <em>controller</em> de cada pantalla<a class="headerlink" href="#el-controller-de-cada-pantalla" title="Permanent link">&para;</a></h3>
<p>Simplificando, cada pantalla de nuestra app está controlada por una clase descendiente de la clase de UIKit <code>UIViewController</code>. Como ya hemos visto unas cuantas veces, la pantalla inicial de cada <em>app</em> está asociada a la clase <code>ViewController</code> de la plantilla. Puedes ver esto en Xcode, seleccionando con el ratón el <em>view controller</em> y yendo al icono del <code>Identity inspector</code> en el panel de la derecha: <img alt="" src="../images/identity_inspector.png" />. </p>
<p>Para seleccionar el <em>view controller</em> con el ratón pulsa el icono del círculo amarillo con un cuadrado dentro que aparece en la barra de su parte superior. </p>
<p><img alt="" src="../images/vc_icon.png" /></p>
<blockquote>
<p>Otra opción es seleccionarlo en el panel que aparece a la izquierda del <em>storyboard</em> con el árbol de componentes</p>
<p><img alt="" src="../images/component_tree.png" /></p>
</blockquote>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p><strong>(continúa)</strong> Selecciona el View Controller de la única pantalla por el momento de la app y simplemente comprueba en el panel de la derecha que la clase asociada es <code>ViewController</code>. Si quisieras cambiar la clase lo harías aquí (¡pero no lo hagas!).</p>
</div>
<p>Podemos añadir nuevas pantallas a nuestra <em>app</em> arrastrando al <em>storyboard</em> un componente de tipo <code>View Controller</code> del panel de componentes de UI. </p>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p><strong>(continúa)</strong> Añade una nueva pantalla a tu <em>app</em>, arrastrando un  <em>view controller</em> al <em>storyboard</em>. Está en el mismo panel que el resto de los componentes de UI como botones, labels,...(recuerda que se accede con el botón <code>+</code> de la esquina superior derecha de Xcode). Ahora el <em>storyboard</em> debe mostrar que tienes dos pantallas, aunque por el momento estarán desconectadas entre sí</p>
<p><img alt="" src="../images/2_pantallas.png" /></p>
</div>
<p>Por defecto, estos nuevos view controller estarán asociados a clases propias de iOS, y si queremos personalizar su comportamiento tendremos que crear una clase propia que herede de <code>UIViewController</code> e implemente los métodos básicos de gestión del ciclo de vida. En Xcode hay una plantilla para ello. Hay que:</p>
<ol>
<li>ir al menú <code>File &gt; New &gt; File...</code> </li>
<li>En la primera pantalla del asistente que aparecerá seleccionar <code>Cocoa Touch Class</code>, pulsar <code>Next</code></li>
<li>Poner un nombre a nuestra clase, por ejemplo <code>ViewControllerSecundario</code> y en <code>Subclass of</code> poner <code>UIViewController</code>, ya que necesitamos que herede de esta clase. </li>
<li>Dejar desmarcada la casilla <code>also create .XIB File</code>. </li>
<li>Pulsar <code>Next</code></li>
<li>Finalmente nos dejará elegir dónde guardar físicamente el archivo swift, podemos dejarlo por defecto y pulsar <code>Create</code></li>
</ol>
<p>Si todo va bien verás que entre los archivos del proyecto aparece la nueva clase creada y que tiene la estructura tipica de un view controller (tiene por ejemplo un <code>viewDidLoad</code>).</p>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p><strong>(continúa)</strong> Sigue las instrucciones anteriores para crear una clase <code>ViewControllerSecundario</code>, que después asociaremos a la pantalla secundaria.</p>
</div>
<p>Ya solo nos queda asociar la clase creada a la "pantalla" del <em>storyboard</em>. Recordemos que eso se hace en el <code>Identity inspector</code> <img alt="" src="../images/identity_inspector.png" /> del panel de la derecha.</p>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p><strong>(continúa)</strong> Teniendo seleccionado el <em>view controller</em> de la segunda pantalla que añadiste al <em>storyboard</em> (recuerda, clic en el icono del círculo amarillo con un cuadrado blanco dentro) ve al <code>Identity inspector</code> y cambia el <code>Class</code> por <code>ViewControllerSecundario</code>.</p>
<p>Para comprobar que funciona:</p>
<ol>
<li>Mete un <code>print("hola, soy el controller secundario")</code> en el <code>viewDidLoad()</code> del <code>ViewControllerSecundario</code></li>
<li>Como las pantallas todavía están desconectadas y no se puede llegar a la segunda desde la primera, puedes hacer temporalmente que la segunda sea la inicial arrastrando a ella la flecha que indica que es controlador inicial</li>
</ol>
<p><img alt="" src="../images/secundaria_como_inicial.png" /></p>
<ol start="3">
<li>Ejecuta la app, y como la pantalla inicial ahora es la segunda y su controller el <code>ViewControllerSecundario</code>, debería aparecer en la consola de Xcode el mensaje de <code>hola, soy el controller secundario</code>.</li>
<li>Acuérdate de dejar otra vez la primera pantalla como pantalla inicial arrastrando la flechita que lo indica.</li>
</ol>
</div>
<h2 id="segues">Segues<a class="headerlink" href="#segues" title="Permanent link">&para;</a></h2>
<p>Son las transiciones entre los <em>controllers</em>. Podemos <strong>crear un <em>segue</em> visualmente</strong> con <code>Ctrl+Arrastrar</code> entre un elemento cualquiera de un view controller (por ejemplo un botón), que será el de <em>controller</em> de origen, y el <em>controller</em> destino. Se nos dará opción a elegir el tipo de <em>segue</em> en un menú contextual.</p>
<p><img alt="" src="../images/tipos_segue.png" /></p>
<h3 id="tipos-basicos-de-segue">Tipos básicos de <em>segue</em><a class="headerlink" href="#tipos-basicos-de-segue" title="Permanent link">&para;</a></h3>
<p>Como vemos en el menú contextual hay cuatro tipos de <em>segue</em>. Dos de ellos son <em>mostrar</em> (<em>show</em>) y otros dos <em>presentar</em> (<em>present</em>). Además podemos programar nuestro propio tipo de <em>segue</em> con <em>custom</em>.</p>
<ul>
<li><em>Show</em> es la forma recomendada habitualmente, ya que permite que el controlador actual “decida” cómo mostrar físicamente el nuevo. Por ejemplo si el controlador actual “ocupa” toda la pantalla, el nuevo también lo hará, pero si por ejemplo es un <em>tab bar controller</em> solo cambiará la parte de la pantalla que muestra contenido, no la barra de herramientas
<img alt="Tab bar controller: cuando se muestra un nuevo controlador, se hace solo en el área de contenido, sin &quot;machacar&quot; la barra de botones" src="../images/tab_bar.png" /></li>
<li><em>Present</em> quiere decir que el nuevo <em>controller</em> se mostrará de forma modal, de manera similar a cuando en un interfaz gráfico se muestra por ejemplo un cuadro de diálogo modal. No obstante esto no quiere decir que el <em>controller</em> antiguo se siga viendo “por debajo”, ya que en dispositivos con tamaño de pantalla limitado el nuevo ocupará toda la pantalla. </li>
</ul>
<p>Como vemos en el menú contextual, en el caso del <em>show</em> se distingue además entre <code>Show</code> “a secas” y <code>Show detail</code>. El primero es el indicado cuando el nuevo <em>controller</em> va a sustituir completamente al anterior y el segundo cuando el nuevo es “secundario” con respecto al anterior (como en el ejemplo que poníamos del <em>tab bar</em>).</p>
<p>En el caso del <em>present</em>, se distingue entre <code>Present Modally</code> y <code>Present As Popover</code>. El primero sería lo que todo el mundo entiende por “modal”: el nuevo controller se pone “encima” del anterior. El segundo es el típico <em>popover</em> que aparece en el iPad.</p>
<p><img alt="Tomado de la documentación de Apple" src="../images/DraggedImage-3.png" title="Tomado de la documentación de Apple" /></p>
<blockquote>
<p>En realidad la forma concreta de mostrar exactamente el nuevo controlador la decide iOS dependiendo de las dimensiones actuales del dispositivo. Por ejemplo en un iPhone SE en vertical no aparecerá un <em>popover</em> aunque lo especifiquemos, la que la pantalla es muy pequeña para ello.</p>
</blockquote>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p><strong>(continúa...)</strong> Agrega un <em>segue</em> entre el botón de la primera pantalla y la segunda, recuerda que debes usar <code>Crtl</code>+arrastrar. Ejecuta la <em>app</em> para comprobar que efectivamente se cambia de pantalla pulsando en el botón, aunque de momento <em>no podrás volver atrás</em> (luego veremos cómo se hace).</p>
</div>
<h3 id="estilos-de-presentacion-y-de-transicion">Estilos de presentación y de transición<a class="headerlink" href="#estilos-de-presentacion-y-de-transicion" title="Permanent link">&para;</a></h3>
<p>Podemos usar diversos estilos a la hora de presentar de forma modal un <em>controller</em>. Por ejemplo podemos indicar que el nuevo controlador debe ocupar toda la pantalla, o bien solo el alto dejando una zona a los lados, o bien un recuadro central como un cuadro de diálogo…</p>
<p><img alt="Tomado de la documentación de Apple" src="../images/DraggedImage-4.png" title="Tomado de la documentación de Apple" /></p>
<p>Estos estilos se definen <strong>en una propiedad del <em>controller<em> a presentar, y no del </em>segue</em></strong>. En Xcode podemos cambiarlos con la propiedad <code>Presentation</code> en el <em>attribute inspector</em> <img alt="" src="../images/attr_inspector.png" /> del <em>controller</em>. En Swift especificamos el estilo dando valores a la propiedad <code>modalPresentationStyle</code> del controller que vamos a presentar.</p>
<p>Por otro lado, también podemos especificar una <strong>animación</strong> para la transición entre el <em>controller</em> actual y el siguiente. De nuevo es una propiedad del <em>controller</em> destino, no del <em>segue</em>. En Xcode se controla gráficamente con la propiedad <code>Transition style</code> del <em>inspector de atributos</em>. En Swift con la propiedad <code>modalTransitionStyle</code> del <em>controller</em> a presentar.</p>
<h3 id="pasar-datos-de-un-controller-a-otro-en-un-segue">Pasar datos de un <em>controller</em> a otro en un <em>segue</em><a class="headerlink" href="#pasar-datos-de-un-controller-a-otro-en-un-segue" title="Permanent link">&para;</a></h3>
<p>Cuando se va a saltar de un <em>controller</em> a otro a través de un <em>segue</em>, se llama al método <code>prepare(for:sender:)</code> del <em>controller</em> origen. Podemos sobreescribir este método para pasarle datos al <em>controller</em> destino. El primer parámetro va a instanciarse al <em>segue</em> y a partir de este podemos obtener una referencia al destino.</p>
<p>Por ejemplo supongamos que tenemos dos <em>controller</em> conectados por un <em>segue</em>, y este se dispara con un botón en el primero.</p>
<p>Supongamos que el primer <em>controller</em> es un objeto de la clase <code>ViewController</code>, mientras que el segundo es de la clase <code>ViewControllerSecundario</code>. En el código de <code>ViewControllerSecundario</code> podría haber algo como:</p>
<div class="highlight"><pre><span></span><code><span class="kd">class</span> <span class="nc">ViewControllerSecundario</span> <span class="p">:</span> <span class="bp">UIViewController</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nv">mensaje</span> <span class="p">=</span> <span class="s">&quot;&quot;</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="kc">super</span><span class="p">.</span><span class="n">viewDidLoad</span><span class="p">()</span>
        <span class="bp">print</span><span class="p">(</span><span class="kc">self</span><span class="p">.</span><span class="n">mensaje</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Es decir, imprimimos un mensaje cuando se carga la pantalla (lo normal sería mostrarlo en un <code>label</code> o similar, pero para los propósitos de este ejemplo nos basta con que salga en la consola).</p>
<p>Podemos acceder a esta propiedad <code>texto</code> desde el <em>controller</em> anterior sobreescribiendo el método <code>prepare(for:sender:)</code></p>
<div class="highlight"><pre><span></span><code><span class="kr">override</span> <span class="kd">func</span> <span class="nf">prepare</span><span class="p">(</span><span class="k">for</span> <span class="n">segue</span><span class="p">:</span> <span class="bp">UIStoryboardSegue</span><span class="p">,</span> <span class="n">sender</span><span class="p">:</span> <span class="nb">Any</span><span class="p">?)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">segue</span><span class="p">.</span><span class="n">identifier</span><span class="p">==</span><span class="s">&quot;siguiente&quot;</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="kd">let</span> <span class="nv">vc2</span> <span class="p">=</span> <span class="n">segue</span><span class="p">.</span><span class="n">destination</span> <span class="k">as</span><span class="p">?</span> <span class="n">ViewControllerSecundario</span> <span class="p">{</span>
                <span class="n">vc2</span><span class="p">.</span><span class="n">mensaje</span> <span class="p">=</span> <span class="s">&quot;Bienvenidos a la pantalla 2&quot;</span>
            <span class="p">}</span>
        <span class="p">}</span>
 <span class="p">}</span>
</code></pre></div>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p><strong>(Continúa...)</strong> prueba el código anterior en la <em>app</em> y comprueba que efectivamente cuando se pasa de una pantalla a otra, la información se está pasando de un <em>controller</em> a otro. En lugar de tomar un mensaje fijo "bienvenidos a la pantalla 2", haz que se pase e imprima lo que se escriba en el campo de texto de la pantalla 1.</p>
</div>
<h3 id="segues-que-vuelven-atras-unwind-segues"><em>Segues</em> que vuelven atrás (<em>unwind segues</em>)<a class="headerlink" href="#segues-que-vuelven-atras-unwind-segues" title="Permanent link">&para;</a></h3>
<p>Los <em>segues</em> que vuelven atrás se llaman <em>unwind segues</em> y se crean de forma distinta a los <em>segues</em> convencionales, ya que la "parte principal" del <em>segue</em> se crea en el controller destino, y no en el origen. Esto nos permite "deshacer" por ejemplo varias transiciones a la vez, volviendo varias pantallas atrás.</p>
<p>En el <em>controller</em> <em>destino de la vuelta</em> debemos implementar lo que se llama un <em>unwind action</em>, un método que puede tener el nombre que deseemos pero debe tener una signatura específica:</p>
<ul>
<li>Está marcada con un <code>@IBAction</code></li>
<li>Tiene como único parámetro un <code>UIStoryboardSegue</code>, que es el <em>segue</em> que se está usando para volver atrás. Por ejemplo</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kr">@IBAction</span> <span class="kd">func</span> <span class="nf">miUnwind</span><span class="p">(</span><span class="n">segue</span><span class="p">:</span> <span class="bp">UIStoryboardSegue</span><span class="p">)</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Volviendo atrás por </span><span class="si">\(</span><span class="n">segue</span><span class="p">.</span><span class="n">identifier</span><span class="si">)</span><span class="s">...&quot;</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div>
<p>Ahora en la pantalla que dispara el <em>unwind</em> debemos conectar usando <code>Ctrl+Arrastrar</code> el elemento de interfaz que produce la vuelta atrás con el icono de <code>Exit</code> que aparece en la parte de arriba.</p>
<p><img alt="" src="../images/unwind_segue.png" /></p>
<blockquote>
<p>Si intentamos hacer esta operación de <code>Ctrl+Arrastrar</code> sin haber implementado el método anterior, veremos que no tiene efecto</p>
</blockquote>
<p>En el método del <em>unwinding</em>, nótese que podemos usar el parámetro, que es el <em>segue</em>, para obtener el <code>destination</code>, que ahora será el <em>controller</em> al que volvemos.</p>
<div class="admonition ejercicio">
<p class="admonition-title">Ejercicio</p>
<p><strong>(Continúa...)</strong> </p>
<ul>
<li>Crea un botón "Atrás" en la segunda pantalla</li>
<li>Implementa un <em>unwind action</em> en el <code>ViewControllerSecundario</code>, recuerda que debe ser un método marcado con <code>@IBAction</code> y con un parámetro de tipo <code>UIStoryboardSegue</code></li>
<li>Conecta gráficamente el botón "Atrás" con el icono de "Exit" de la segunda pantalla.</li>
</ul>
<p>comprueba que ya se puede ir adelante y atrás en el <em>segue</em></p>
</div>
<p>Finalmente, decir que cuando se produce un <em>unwind</em>, el controlador desde el que se vuelve también recibe una llamada a <code>prepare(for:sender:)</code>, método que podemos sobreescribir si queremos aprovechar para realizar alguna operación antes de volver.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
        
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Pie">
      
        
        <a href="../../2_vistas/ejercicios/" class="md-footer__link md-footer__link--prev" aria-label="Anterior: Ejercicios sobre vistas" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Anterior
              </span>
              Ejercicios sobre vistas
            </div>
          </div>
        </a>
      
      
        
        <a href="../ejercicios/" class="md-footer__link md-footer__link--next" aria-label="Siguiente: Ejercicios de controllers" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Siguiente
              </span>
              Ejercicios de controllers
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        
          Made with
          <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
            Material for MkDocs
          </a>
        
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": [], "translations": {"clipboard.copy": "Copiar al portapapeles", "clipboard.copied": "Copiado al portapapeles", "search.config.lang": "es", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "B\u00fasqueda", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.term.missing": "Falta", "select.version.title": "Seleccionar versi\u00f3n"}, "search": "../../assets/javascripts/workers/search.e99e714c.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.bc35569b.min.js"></script>
      
    
  </body>
</html>